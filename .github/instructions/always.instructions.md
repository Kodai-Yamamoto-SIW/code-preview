---
applyTo: '**'
---
# AIへのソースコード作成指示書 (@kodai-yamamoto-siw/code-preview)

このプロジェクトは、Docusaurusなどで使用するための **React + TypeScript** 製のコードプレビューライブラリです。
以下のガイドラインに従って、保守性が高く、バグの少ないコードを作成してください。

## 1. 基本原則 (最優先)

- **SOLID原則**: 各コンポーネントや関数は単一責任を持ち、拡張に対して開かれ、修正に対して閉じているように設計する。
- **DRY原則 (Don't Repeat Yourself)**: ロジックの重複を避け、共通処理はカスタムフックやユーティリティに切り出す。
- **Clean Code**: 変数名・関数名は自己説明的にし、コード自体がドキュメントとなるようにする。

## 2. 技術スタックと方針

- **言語**: TypeScript (Strict mode)
- **フレームワーク**: React (>=18)
- **ビルドツール**: Rollup
- **スタイリング**: CSS Modules (`*.module.css`)
- **エディタ**: Monaco Editor (`@monaco-editor/react`)

### 実装方針
- **関数コンポーネント & Hooks**: クラスコンポーネントは使用せず、全て関数コンポーネントと Hooks で実装する。
- **既存ライブラリの活用**: 車輪の再発明を避け、信頼性の高い既存のライブラリがある場合は積極的に採用する（保守性と品質の担保のため）。

## 3. TypeScript & 型定義

- **型安全性**: `any` の使用は原則禁止。不明な型は `unknown` を使用し、適切に型ガードを行う。
- **Props定義**: コンポーネントの Props は `interface` で定義し、必ず **JSDocコメント** を付与する（ライブラリ利用者へのドキュメントとなるため）。
- **エクスポート**: `React.FC` は使用せず、通常の関数宣言を使用する。
  ```tsx
  // Good
  export interface MyComponentProps {
      /** ボタンのラベル */
      label: string;
  }
  export const MyComponent = ({ label }: MyComponentProps) => { ... };
  ```

## 4. スタイリング (CSS Modules)

- **CSS Modules**: スタイルの衝突を防ぐため、CSS Modules を使用する。
- **命名規則**: クラス名はキャメルケース（例: `.container`, `.activeTab`）を推奨し、JS側からは `styles.container` のように参照する。

## 5. コーディング規約

- **命名**: 変数名・関数名は具体的で意味のある英語にする（`data`, `temp` 禁止）。
- **早期リターン**: ネストを深くしないため、ガード節を使用して早期リターンする。
- **コメント**: 複雑なアルゴリズムや「なぜそうしたか」という理由にはコメントを残す。

## 6. テストと品質

- **副作用の管理**: `useEffect` は必要最小限にし、依存配列を正しく設定する。
- **エラーハンドリング**: ユーザー入力（HTML/CSS/JSコード）は信頼できないものとして扱い、プレビュー生成時などにエラーが発生してもアプリ全体がクラッシュしないように `try-catch` や Error Boundary で保護する。
